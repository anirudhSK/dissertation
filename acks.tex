\chapter*{Acknowledgments}
\addcontentsline{toc}{chapter}{Acknowledgments}%

As a Ph.D. student, I was fortunate to work with two outstanding advisors, Hari
Balakrishnan and Mohammad Alizadeh. Each contributed a unique perspective to my
research.  Hari was the master of the highest-order bit. He taught me to focus
on the most important thing at every turn, whether it was an elusive sentence
required to finish a paragraph, the key takeaway from a slide, or a single
sentence summarizing a paper's novelty. Hari took me on as his student when my
options were limited; this dissertation is my way of repaying that debt.
Mohammad taught me to persist until a concept was clear to the point of being
obvious. He made me appreciate the peace of mind that comes with mathematical
rigor and showed me how to work with hardware engineers.  Most importantly, he
taught me how to listen and continuously incorporate feedback into my research.

Keith Winstein was a friend and mentor through grad school. He taught me to
love clean code, corrected my writing, showed me how to give an engaging talk,
and convinced me that it was always possible to program a computer to do your
bidding. In April 2013, he wrote a blog post wondering why software-defined
networking did not include the data plane. This dissertation is a belated
answer to his question.

My thesis committee members, George Varghese and Nick McKeown, helped shape my
research taste. George taught me to go beyond the surface in interdisciplinary
research. He pushed me to discover precise connections to and differences from
adjacent disciplines. Nick suggested that I spend some time interning at
Barefoot Networks---an internship that significantly improved my dissertation.
He showed me through his own example that it was possible to combine
intellectual rigor and practical impact.

As part of my dissertation work, I spent a year interning at Barefoot Networks.
It is not often that a fledgling startup gives an intern free rein to pursue
open-ended research. My manager, Changhoon Kim, gave me the freedom to go after
ideas that I thought were interesting, while ensuring that I was still
productive.  Mihai Budiu taught me how to engineer a compiler. Anurag Agrawal
patiently explained a router's scheduler to me. In addition, I benefited from
conversations with many other engineers and interns at Barefoot, including
Antonin, KRam, Ravindra, CK, Pat, Mike, and Naga.

This dissertation is the result of joint work with many collaborators: Alvin
Cheung, Mihai Budiu, Changhoon Kim, Mohammad Alizadeh, Hari Balakrishnan,
George Varghese, Nick McKeown, Steve Licking, Suvinay Subramanian, Sharad
Chole, Shang-Tse Chuang, Anurag Agrawal, Tom Edsall, Sachin Katti, Srinivas
Narayana, Vikram Nathan, Prateesh Goyal, Venkat Arun, and Vimalkumar Jeyakumar.
The broader P4 community provided an ideal setting for my work, both to get
feedback and for translating some of these ideas into practice. 

My MIT colleagues past and present, Ravi, Amy, Vikram, Tiffany, Shuo,
Katrina, Lenin, Jonathan, Peter, Hongzi, Pratiksha, Somak, Ameesh, Alvin,
Eugene, Swarun, Jason, and Tushar, provided a great reason to come to work, whether to bounce
off ideas, get feedback on a talk or paper draft, complain about grad school,
get ice cream at Tosci's, or play an afternoon game of ping-pong. In
particular, Ravi has been a great sounding board over the years, tempering my
naive optimism with some practical reality checks.

Suvinay and I spent many years in grad school together.  I am grateful for our
friendship and for his ability to patiently explain hardware to me at all hours
of the day and night. As undergrads, Srinivas and I spent many sleepless nights
debugging problem sets together. Srinivas started his post doc at MIT just as I
was looking around for ideas, allowing us to work together again on a slightly
harder problem set: Chapter~\ref{chap:perf_query}.  My friends outside grad school, Raghav,
Aakash, Akhil, Raghunandan, Siddharth, and Praneeth, provided me with
much-needed breaks from work with the occasional catch ups.

Sheila Marian was a phenomenal admin assistant, assisting with paper work when
I was away from MIT, booking travel for me, and ordering cakes for thesis
defenses. Janet Fischer at the EECS graduate office patiently extended every
Ph.D.  deadline. My academic advisor, Piotr Indyk, looked out for me since my
first year at MIT, especially when I was switching advisors.  Sylvia Hiestand
at the MIT ISO got all of my paper work in order
during my year away from MIT.

My parents, Rama and Sivaraman, put up with my churlish ways during my time in
grad school. I am grateful to them for their patience and for not asking me
when I would graduate. My sister, Vibhaa, patiently proofread this dissertation
and filed it on my behalf.  My
grandmother's utter lack of interest in my research is a much needed breath of
fresh air. My in-laws were a steady source of support from afar during my job
search. My wife, Tejaswi, went through both the highs and lows of my Ph.D.
along with me. I am grateful for her ability to listen carefully, for believing
in me for no good reason, and for her honest advice during difficult times. 

My late grandfather, Dr. V. Ramamurti, was the reason I embarked on a Ph.D.
Throughout high school, he spent an inordinate amount of time patiently
teaching me mathematics and physics and indulging my pesky questions. As a
faculty member, who also consulted for industry, he taught me not to stray too
far from reality when conducting research. I dedicate this dissertation to him.
